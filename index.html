<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A professional financial planning website with articles and calculators for smart money management.">
    <title>News Hub</title>

    <!-- Canonical link tag to prevent duplicate content issues.
    Be sure to update the href with your actual website URL. -->
    <link rel="canonical" href="https://yourwebsite.com/index.html">

    <!-- Open Graph Meta Tags for social media sharing -->
    <meta property="og:title" content="Smart Finance Planner: Your Guide to Financial Freedom">
    <meta property="og:description" content="A professional financial planning website with articles and calculators for smart money management.">
    <meta property="og:image" content="https://placehold.co/1200x630/2563EB/ffffff?text=Smart+Finance+Planner">
    <meta property="og:url" content="https://yourwebsite.com/index.html">
    <meta property="og:type" content="website">

    <!-- Schema.org Structured Data (JSON-LD) for search engines -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@graph": [
          {
            "@type": "WebSite",
            "name": "Smart Finance Planner",
            "url": "https://yourwebsite.com",
            "about": "A guide to financial planning and freedom.",
            "description": "A professional financial planning website with articles and calculators for smart money management."
          },
          {
            "@type": "Article",
            "headline": "The Roadmap to Financial Freedom: A 1000-Word Guide",
            "description": "A practical, step-by-step roadmap to help you navigate the journey toward true financial independence.",
            "image": "https://img.freepik.com/free-photo/finance-concept_23-2148165794.jpg",
            "author": {
              "@type": "Person",
              "name": "Financial Planner"
            },
            "publisher": {
              "@type": "Organization",
              "name": "Smart Finance Planner",
              "logo": {
                "@type": "ImageObject",
                "url": "https://yourwebsite.com/logo.png"
              }
            },
            "datePublished": "2025-09-22"
          }
        ]
      }
    </script>

    <!-- Tailwind CSS CDN for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for a clean, professional font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style to hide the calculator container by default */
        .calculator-container.hidden {
            display: none;
        }

        /* Notification Modal styles */
        .notification-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        .notification-modal-content {
            background-color: #fff;
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            width: 90%;
            text-align: center;
            position: relative;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Header -->
    <header class="bg-blue-600 text-white py-12 shadow-lg relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight">News Hub</h1>
            <p class="mt-4 text-xl sm:text-2xl font-light opacity-90">Your guide to financial freedom. Explore articles and use our tools to plan your future.</p>
        </div>
        <nav class="mt-4 md:mt-0 flex justify-center items-center">
            <ul class="flex space-x-4 md:space-x-6 text-white">
                <li><a href="#" id="nav-finance" class="text-lg font-medium hover:text-blue-200 transition-colors duration-300">Finance</a></li>
                <li><a href="#" id="nav-technology" class="text-lg font-medium hover:text-blue-200 transition-colors duration-300">Technology</a></li>
                <li><a href="#" id="nav-entertainment" class="text-lg font-medium hover:text-blue-200 transition-colors duration-300">Entertainment</a></li>
            </ul>
        </nav>
        <!-- Notification icon and subscribe button -->
        <div class="absolute top-4 right-4 flex items-center space-x-4">
            <button id="subscribeBtn" class="bg-white text-blue-600 py-2 px-4 rounded-full text-sm font-semibold hover:bg-gray-100 transition-colors duration-200">
                Subscribe to Updates
            </button>
            <button id="notificationBtn" class="relative text-white hover:text-blue-200 transition-colors duration-300">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15h2v-2h-2v2zm0-4h2V7h-2v6z"/>
                </svg>
                <span id="notificationBadge" class="absolute top-0 right-0 h-4 w-4 bg-red-500 rounded-full border-2 border-white transform translate-x-1 -translate-y-1 hidden"></span>
            </button>
        </div>
    </header>

    <!-- Subscription Confirmation Toast -->
    <div id="subscriptionToast" class="fixed bottom-4 left-1/2 -translate-x-1/2 bg-green-600 text-white py-3 px-6 rounded-lg shadow-lg z-50 transform scale-0 opacity-0 transition-all duration-300 ease-out">
        आप अब सफलतापूर्वक सब्सक्राइब हो गए हैं!
    </div>

    <!-- Notification Modal -->
    <div id="notificationModal" class="notification-modal-overlay">
        <div class="notification-modal-content" data-category="">
            <h3 class="text-2xl font-bold mb-4">You have a new update!</h3>
            <p id="notificationMessage" class="text-gray-600">You have a new update.</p>
            <p id="userIdDisplay" class="text-xs text-gray-400 mt-4 break-all"></p>
            <div class="mt-6 flex justify-center space-x-4">
                <a id="readNowBtn" href="#" class="bg-blue-600 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-700 transition-colors duration-200">
                    Read Now
                </a>
                <button id="closeNotificationBtn" class="bg-gray-200 text-gray-700 py-2 px-6 rounded-full font-semibold hover:bg-gray-300 transition-colors duration-200">
                    Close
                </button>
            </div>
        </div>
    </div>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z6JJ742VHG"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-Z6JJ742VHG');
    </script>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">

        <!-- Articles Section -->
        <section>
            <h2 id="sectionTitle" class="text-3xl font-bold text-center text-gray-900 mb-8">Finance Articles</h2>
            <div class="card-grid grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8" id="blogCards">
                <!-- Cards will be generated dynamically -->
            </div>
        </section>

        <!-- Dynamic Article Container -->
        <div id="articleContainer" class="bg-white rounded-xl shadow-2xl p-8 mt-12 transition-all duration-300" style="display:none;">
            <div class="mb-8">
                <img id="articleImage" src="" alt="Article image" class="w-full h-72 object-cover rounded-xl shadow-md">
            </div>
            <div class="article-content text-lg leading-relaxed">
                <h2 id="articleTitle" class="text-4xl font-bold text-blue-600 mb-4"></h2>
                <div id="articleText" class="prose max-w-none"></div>
            </div>
            <div id="navButtons" class="flex justify-between mt-8">
                <button id="backBtn" class="flex items-center space-x-2 bg-gray-200 text-gray-700 py-3 px-6 rounded-full font-semibold hover:bg-gray-300 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                    </svg>
                    <span>Back to Articles</span>
                </button>
                <button id="nextBtn" class="flex items-center space-x-2 bg-blue-600 text-white py-3 px-6 rounded-full font-semibold hover:bg-blue-700 transition-colors duration-200">
                    <span>Next Article</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
        </div>

        <hr class="my-12 border-t-2 border-gray-200">

        <!-- Financial Calculators Section - now conditionally visible -->
        <section class="calculator-container bg-white rounded-xl shadow-2xl p-8 hidden">
            <h2 class="text-3xl font-bold text-center text-gray-900 mb-8">Financial Calculators</h2>
            <div class="flex flex-col lg:flex-row space-y-8 lg:space-y-0 lg:space-x-8">

                <!-- SIP Calculator -->
                <div class="calculator-card flex-1 bg-blue-50 p-6 rounded-xl shadow-md">
                    <h3 class="text-2xl font-semibold text-blue-800 mb-6">SIP Calculator</h3>
                    <div class="calculator-input mb-6">
                        <label for="sipAmount" class="block font-medium mb-2">Monthly Investment (₹):</label>
                        <input type="number" id="sipAmount" value="5000" class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                    </div>
                    <div class="calculator-input mb-6">
                        <label for="sipReturn" class="block font-medium mb-2">Expected Return Rate (% p.a.):</label>
                        <input type="number" id="sipReturn" value="12" class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                    </div>
                    <div class="calculator-input mb-8">
                        <label for="sipYears" class="block font-medium mb-2">Time Period (Years):</label>
                        <input type="number" id="sipYears" value="10" class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                    </div>
                    <button class="calc-button w-full bg-blue-600 text-white py-3 rounded-md font-semibold hover:bg-blue-700 transition-colors" onclick="calculateSIP()">Calculate SIP</button>
                    <div class="calculator-result mt-6 text-center text-lg font-bold" id="sipResult"></div>
                </div>

                <!-- Lumpsum Calculator -->
                <div class="calculator-card flex-1 bg-blue-50 p-6 rounded-xl shadow-md">
                    <h3 class="text-2xl font-semibold text-blue-800 mb-6">Lumpsum Calculator</h3>
                    <div class="calculator-input mb-6">
                        <label for="lumpsumAmount" class="block font-medium mb-2">Total Investment (₹):</label>
                        <input type="number" id="lumpsumAmount" value="100000" class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                    </div>
                    <div class="calculator-input mb-6">
                        <label for="lumpsumReturn" class="block font-medium mb-2">Expected Return Rate (% p.a.):</label>
                        <input type="number" id="lumpsumReturn" value="12" class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                    </div>
                    <div class="calculator-input mb-8">
                        <label for="lumpsumYears" class="block font-medium mb-2">Time Period (Years):</label>
                        <input type="number" id="lumpsumYears" value="10" class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                    </div>
                    <button class="calc-button w-full bg-blue-600 text-white py-3 rounded-md font-semibold hover:bg-blue-700 transition-colors" onclick="calculateLumpsum()">Calculate Lumpsum</button>
                    <div class="calculator-result mt-6 text-center text-lg font-bold" id="lumpsumResult"></div>
                </div>
            </div>
        </section>

    </main>

    <footer class="mt-12 py-8 bg-gray-100 text-center text-gray-500 text-sm">
        <p>Disclaimer: This website and its content are for informational and educational purposes only. The calculators and articles are not intended to be and do not constitute financial advice. You should not make any financial decisions based on the information provided here without consulting a qualified financial professional.</p>
    </footer>

    <script type="module">
        // Firebase imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, onSnapshot, serverTimestamp, getDocs, collection } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Enable Firestore debug logging
        setLogLevel('debug');

        // Global variables provided by the environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // Initialize Firebase
        let app;
        let db;
        let auth;
        let userId = '';
        let userHasSubscribed = false;
        
        try {
            if (Object.keys(firebaseConfig).length > 0) {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
            } else {
                console.warn("Firebase config is missing. Services will not be available.");
            }
        } catch (e) {
            console.error("Failed to initialize Firebase:", e);
        }

        const notificationBadge = document.getElementById('notificationBadge');
        const notificationModal = document.getElementById('notificationModal');
        const notificationMessage = document.getElementById('notificationMessage');
        const userIdDisplay = document.getElementById('userIdDisplay');
        const readNowBtn = document.getElementById('readNowBtn');
        const closeNotificationBtn = document.getElementById('closeNotificationBtn');
        const subscribeBtn = document.getElementById('subscribeBtn');
        const subscriptionToast = document.getElementById('subscriptionToast');

        const navLinks = {
            'nav-finance': document.getElementById('nav-finance'),
            'nav-technology': document.getElementById('nav-technology'),
            'nav-entertainment': document.getElementById('nav-entertainment')
        };
        const sectionTitle = document.getElementById('sectionTitle');
        const blogCards = document.getElementById('blogCards');
        const articleContainer = document.getElementById('articleContainer');
        const articleTitle = document.getElementById('articleTitle');
        const articleImage = document.getElementById('articleImage');
        const articleText = document.getElementById('articleText');
        const backBtn = document.getElementById('backBtn');
        const nextBtn = document.getElementById('nextBtn');
        let currentArticleIndex = 0;
        let currentCategory = 'finance';
        let articlesData = []; // This will hold all articles

        // All articles with their full content, now including Technology and Entertainment
        const articles = [
            // Finance Articles
            { id: 1, category: "finance", title: "10 Smart Financial Planning Tips for Beginners", content: "<p>Financial planning is a crucial step that can help you secure your future and achieve your goals. Here are 10 easy and smart financial tips for beginners:</p><h3>1. Create and Stick to a Budget</h3><p>This is the most important part of financial planning. Track your monthly income and expenses. A budget helps you understand where your money is going and where you can cut unnecessary expenses.</p><h3>2. Build an Emergency Fund</h3><p>Having an emergency fund is essential for unexpected situations, such as job loss or medical emergencies. Keep an amount equal to 3-6 months of living expenses in a savings account.</p><h3>3. Get Rid of High-Interest Debts</h3><p>High interest on credit cards or personal loans can drain your wealth quickly. First, focus on paying off the highest-interest debts.</p><h3>4. Set Clear Financial Goals</h3><p>Whether it's buying a house, saving for retirement, or just saving a specific amount in a year, having clear goals is very important. Write down these goals with a timeline.</p><h3>5. Start Investing Early</h3><p>Start investing as early as possible to take advantage of the \"power of compounding.\" Even if it's a small amount, like an SIP, it can give huge returns in the long run.</p><h3>6. Monitor Your Spending Habits</h3><p>Use an app or a spreadsheet to record all your expenses. This will help you identify areas where you can save.</p><h3>7. Get Insurance</h3><p>Take basic insurance like life, health, and term insurance. Insurance protects you from unexpected events and helps maintain your financial stability.</p><h3>8. Understand and Improve Your Credit Score</h3><p>A good credit score is important for getting loans and credit cards in the future. Maintain it by paying bills on time and keeping your credit utilization low.</p><h3>9. Educate Yourself Financially</h3><p>Read about investment types, taxes, and money management. Books, podcasts, and reliable websites can help you become financially literate.</p><h3>10. Regularly Review Your Financial Plan</h3><p>Life changes, and so can your financial goals. Regularly review your budget and investments to ensure you are on the right track.</p>", image: "https://img.freepik.com/free-photo/finance-concept_23-2148165794.jpg" },
            { id: 2, category: "finance", title: "How to Create a Monthly Budget That Actually Works", content: "<p>Creating an effective monthly budget is both an art and a science. It's a tool that can help you take control of your money. Follow the steps below:</p><h3>1. Find Your Monthly Income</h3><p>Add up your total income from all sources. This includes your salary, freelancing income, or any other regular income.</p><h3>2. Track All Your Expenses</h3><p>Record every expense you make for a month. This includes things like rent, electricity bills, groceries, and entertainment.</p><h3>3. Implement the 50/30/20 Rule</h3><p>This is a simple budgeting rule. Spend 50% of your income on \"Needs,\" 30% on \"Wants,\" and put 20% towards \"Savings & Debt.\"</p><h3>4. Customize the Budget</h3><p>Adjust your budget according to your goals and lifestyle. If you are saving for a house, you can increase the savings portion.</p><h3>5. Review Regularly</h3><p>Review your budget monthly. See where you were successful and where you need to improve. This will help you stay on track.</p>", image: "https://img.freepik.com/free-photo/budget-planning_23-2148127345.jpg" },
            { id: 3, category: "finance", title: "Top 7 Investment Options for 2025", content: "<p>There are many investment options. Based on your financial goals and risk tolerance, you can choose from these top 7 options:</p><h3>1. Mutual Funds</h3><p>The most popular option for small investors. You can invest small amounts regularly through SIPs.</p><h3>2. Stock Market</h3><p>High return potential, but also high risk. Choose stocks of good companies for long-term investment.</p><h3>3. Government Schemes</h3><p>Options like Public Provident Fund (PPF) and National Pension Scheme (NPS) provide safe and tax-free returns.</p><h3>4. Real Estate</h3><p>A long-standing investment option. Buying property can give you both rental income and capital appreciation.</p><h3>5. Gold</h3><p>Considered a safe investment, especially during times of economic uncertainty. You can invest in physical gold or Sovereign Gold Bonds.</p><h3>6. Fixed Deposits</h3><p>A safe option for low-risk investors. You can open a fixed deposit with a bank or post office.</p><h3>7. Bonds and Debentures</h3><p>You can earn a fixed income by lending to a company or government. These are less volatile compared to mutual funds and stocks.</p>", image: "https://img.freepik.com/free-photo/indian-stock-market_23-2148189452.jpg" },
            { id: 4, category: "finance", title: "How to Build an Emergency Fund: A Complete Guide", content: "<p>An emergency fund is a financial safety net that prepares you for unexpected expenses.</p><h3>Why is it important?</h3><p>An emergency fund covers unexpected expenses like job loss, medical emergencies, or home repairs. It saves you from taking out a loan.</p><h3>How much should you save?</h3><p>Financial advisors suggest that you should save an amount equal to 3 to 6 months of living expenses.</p><h3>Where to keep the money?</h3><p>Keep it in a high-yield savings account or a short-term fixed deposit. It should be easily accessible.</p><h3>How to start?</h3><p>Set aside a fixed amount from your budget every month. Do this right after you get your salary. Start small and gradually reach your goal.</p>", image: "https://img.freepik.com/free-photo/saving-money-jar_23-2148134278.jpg" },
            { id: 5, category: "finance", title: "Retirement Planning: How Much Should You Save by Age?", content: "<p>Planning for retirement is a long journey, and the earlier you start, the better. Here are some savings tips according to your age:</p><h3>In your 20s: Start as early as possible</h3><p>At this age, you can take full advantage of the magic of compounding. Start saving 10% to 15% of your income for retirement. Investing in a SIP or a mutual fund is a good option.</p><h3>In your 30s: Increase your savings</h3><p>Your income is likely to increase in this decade. Increase your savings to 15% to 20%. Continue to invest in equity according to your risk tolerance.</p><h3>In your 40s: Review your goals</h3><p>Now is the time to review your retirement goals and see if you are on the right track. Try to increase your savings rate to 20% to 25%. Also, consider making your portfolio a little more stable.</p><h3>In your 50s: Finalize your strategy</h3><p>At this time, your goal should be to grow your savings and make your investment strategy risk-free. Start putting money into more secure investment options, such as fixed deposits or bonds.</p><h3>Conclusion</h3><p>No matter what your age is, the most important thing is to start today. Consistent savings and the right investments will help you ensure a secure retirement.</p>", image: "https://img.freepik.com/free-photo/retirement-planning-concept_23-2148165787.jpg" },
            { id: 6, category: "finance", title: "Best Tax-Saving Investments Under Section 80C", content: "<p>Section 80C of the Indian Income Tax Act allows you to save tax on investments up to ₹1.5 lakhs. Here are some popular options:</p><h3>1. Equity Linked Savings Scheme (ELSS)</h3><p>ELSS is a type of mutual fund that invests in stocks. Its lock-in period is only 3 years and it can give good returns in the long run.</p><h3>2. Public Provident Fund (PPF)</h3><p>PPF is a government scheme that provides safe and tax-free returns. Its lock-in period is 15 years and it is a good option for those who do not want to take risks.</p><h3>3. National Pension Scheme (NPS)</h3><p>NPS is a retirement plan that helps you build a large fund in the long run. It also gets additional tax benefits under Section 80C.</p><h3>4. Term Insurance</h3><p>Term insurance premiums are also tax-deductible under Section 80C. It is an essential financial safety net for your family.</p><h3>5. Fixed Deposits (Tax-Saving FDs)</h3><p>These FDs offered by banks and post offices come with a 5-year lock-in period and provide safe returns.</p>", image: "https://img.freepik.com/free-photo/tax-saving-india_23-2148291889.jpg" },
            { id: 7, category: "finance", title: "How to Improve Your Credit Score Fast", content: "<p>Your credit score determines whether you will get a loan or credit card in the future. Take these steps to improve it quickly:</p><h3>1. Pay your bills on time</h3><p>This is the most important factor of a credit score. Pay your credit card bills and loan EMIs on time.</p><h3>2. Keep your credit utilization low</h3><p>Do not use more than 30% of your total credit card limit. For example, if your credit limit is ₹1 lakh, do not spend more than ₹30,000.</p><h3>3. Keep old credit lines open</h3><p>Do not close your oldest credit cards, as this can reduce the length of your credit history.</p><h3>4. Check your credit report</h3><p>Regularly check your credit report and immediately correct any mistakes or errors.</p><h3>5. Avoid unnecessary new loans</h3><p>Do not apply for new credit cards or loans frequently. This can have a negative impact on your score.</p>", image: "https://img.freepik.com/free-photo/credit-score-india_23-2148291782.jpg" },
            { id: 8, category: "finance", title: "Why Term Insurance is a Must for Financial Security", content: "<p>Term insurance is a pure life insurance plan that provides financial security to your family for a fixed term. It is an investment that everyone should have.</p><h3>Low Cost, High Coverage</h3><p>The biggest feature of term insurance is its low premium cost. You can get a large amount of life cover by paying a small premium.</p><h3>Family Protection</h3><p>In the unfortunate event of your demise, the policy amount is given to your family. This helps your family remain financially independent and secures their future.</p><h3>Debt Repayment</h3><p>If you have a home loan or other loans, term insurance ensures that your family does not have to struggle to repay those loans after you.</p><h3>Tax Benefits</h3><p>Term insurance premiums are tax-deductible under Section 80C, and the maturity amount is also tax-free.</p>", image: "https://img.freepik.com/free-photo/insurance-concept_23-2148165739.jpg" },
            { id: 9, category: "finance", title: "Top 5 Passive Income Ideas to Grow Your Wealth", content: "<p>Passive income is income you receive with little active participation. It's a great way to grow your wealth quickly.</p><h3>1. Dividend Stocks and Mutual Funds</h3><p>Invest in the stock market and choose shares of companies that pay regular dividends. This can become a source of regular income for you.</p><h3>2. Real Estate</h3><p>Earn rental income from rented property. This is a stable and reliable source of passive income.</p><h3>3. Blogging or a YouTube Channel</h3><p>Share your knowledge and passion on a blog or YouTube channel. Once your audience grows, you can earn through advertisements, sponsorships, and affiliate marketing.</p><h3>4. Peer-to-Peer Lending</h3><p>Lend to other individuals through a digital platform and earn interest. This is a new and attractive option.</p><h3>5. Sell Digital Products</h3><p>Create and sell digital products like e-books, online courses, or stock photos. Once created, they can be sold again and again.</p>", image: "https://img.freepik.com/free-photo/passive-income-ideas_23-2148189712.jpg" },
            { id: 10, category: "finance", title: "Financial Mistakes to Avoid in Your 20s and 30s", content: "<p>Your 20s and 30s are crucial for laying the foundation of your financial future. Avoid these common mistakes:</p><h3>1. Delaying Savings</h3><p>Starting to save and invest early gives you the full benefit of compounding. Avoid the mindset of \"I'll do it tomorrow.\"</p><h3>2. Taking Expensive Loans</h3><p>Avoid high-interest loans like credit card debt or personal loans. They can become the biggest hurdle in your financial progress.</p><h3>3. Not Building an Emergency Fund</h3><p>Without an emergency fund, unexpected expenses can force you to take out a loan. Start saving from your salary immediately.</p><h3>4. Ignoring Insurance</h3><p>Consider health and term insurance as an investment, not an expense. It protects you from financial crises.</p><h3>5. Spending More Than Your Income</h3><p>Stick to your budget. Do not spend on unnecessary things due to social pressure.</p>", image: "https://img.freepik.com/free-photo/young-adults-financial-mistakes_23-2148165769.jpg" },
            
            // Technology Articles (New)
            { id: 11, category: "technology", title: "The Future of AI in Everyday Life", content: "<p>Artificial Intelligence is no longer a futuristic concept; it's being integrated into our daily lives. From smart home devices to personalized recommendations on streaming platforms, AI is everywhere. The next decade will see AI become even more seamless, anticipating our needs and automating complex tasks, transforming everything from healthcare to transportation.</p><h3>AI in Healthcare</h3><p>AI is being used to analyze medical images, predict disease outbreaks, and even assist in surgery. This is leading to faster diagnoses and more personalized treatment plans for patients.</p><h3>AI in Transportation</h3><p>Self-driving cars are just the beginning. AI is set to revolutionize logistics, public transit, and even air travel, making it safer and more efficient.</p><h3>AI and Personalization</h3><p>Imagine a smart assistant that not only organizes your calendar but also suggests the most efficient way to achieve your goals based on your habits. AI will take personalization to a new level, making our lives more convenient.</p>", image: "https://img.freepik.com/free-photo/ai-human-hand-touching-cyborg-s-hand-glowing-blue-light_23-2149479344.jpg" },
            { id: 12, category: "technology", title: "The Rise of Quantum Computing", content: "<p>Quantum computing uses the principles of quantum mechanics to process information, allowing it to solve problems that are currently impossible for even the most powerful supercomputers. While still in its infancy, it holds the potential to revolutionize fields like cryptography, drug discovery, and material science.</p><h3>How is it Different?</h3><p>Classical computers use bits (0s and 1s) to store data. Quantum computers use qubits, which can represent 0, 1, or both at the same time, thanks to a property called superposition. This allows them to perform complex calculations at an exponential rate. It has the potential to break modern encryption and create unhackable communication. It will also revolutionize drug discovery, by making it possible to simulate molecules and their interactions, leading to new medicines.</p>", image: "https://img.freepik.com/free-photo/glowing-digital-brain-with-binary-code_23-2148405021.jpg" },
            { id: 13, category: "technology", title: "The Next Generation of Smartphones", content: "<p>The smartphone market is constantly evolving, with new innovations coming out every year. The next generation of smartphones will likely focus on foldables, sustainable materials, and even more powerful AI integration. Batteries will get more efficient, and cameras will continue to improve, blurring the line between professional photography and a simple phone snap. The focus will be less on raw power and more on seamless, intuitive user experiences.</p>", image: "https://img.freepik.com/free-photo/futuristic-smartphone-concept_23-2149174246.jpg" },
            { id: 14, category: "technology", title: "The Impact of 5G on the Internet of Things (IoT)", content: "<p>The rollout of 5G networks is not just about faster internet for your phone. Its low latency and high bandwidth will enable the true potential of the Internet of Things (IoT), where a massive number of devices are interconnected. Smart cities will become a reality, with real-time traffic management, smart grids, and intelligent public services. In your home, 5G will enable seamless communication between all your smart devices, from your refrigerator to your security system.</p>", image: "https://img.freepik.com/free-photo/smart-city-network_23-2149254580.jpg" },

            // Entertainment Articles
            { id: 15, category: "entertainment", title: "The Golden Age of Streaming: What to Watch Next", content: "<p>With so many streaming services available, it can be hard to decide what to watch. This golden age of television and film has brought us a plethora of content, from gripping dramas to lighthearted comedies. Whether you're in the mood for a sci-fi epic or a historical documentary, there's something for everyone. Our top picks this month include a psychological thriller that will keep you on the edge of your seat and a heartwarming family drama that's perfect for a cozy night in.</p>", image: "https://img.freepik.com/free-photo/woman-watching-movie-home_23-2149303531.jpg" },
            { id: 16, category: "entertainment", title: "A New Chapter for Video Games: Cloud Gaming is Here", content: "<p>Cloud gaming is changing how we play video games by allowing us to stream games directly to our devices without the need for expensive hardware. This technology is making high-end gaming accessible to a wider audience than ever before. While it still has some challenges, such as latency, the potential for a future where you can play any game on any device is an exciting prospect for gamers worldwide. The next five years will be crucial for this technology.</p>", image: "https://img.freepik.com/free-photo/woman-playing-video-games-vr-headset_23-2149129596.jpg" },
            { id: 17, category: "entertainment", title: "The Future of Music: AI-Generated Hits", content: "<p>Artificial intelligence is starting to make its mark on the music industry. AI-powered tools can now compose original music, generate new beats, and even mimic the style of famous artists. While the idea of AI-generated music may seem controversial to some, it also presents new opportunities for collaboration and creativity. Artists can use these tools to find new inspiration and create unique sounds. The debate over whether AI can truly replace human creativity is just beginning.</p>", image: "https://img.freepik.com/free-photo/mixing-console-with-blue-light_23-2149386629.jpg" },
            { id: 18, category: "entertainment", title: "Behind the Scenes of Blockbuster Movies", content: "<p>Have you ever wondered what it takes to create a blockbuster movie? The process is a complex blend of artistry and technology. From motion-capture to visual effects, the technology used in filmmaking is constantly evolving. A behind-the-scenes look at a modern movie reveals the meticulous planning, hard work, and creative vision required to bring a story to life on the big screen. It’s a true testament to the power of human ingenuity and collaboration.</p>", image: "https://img.freepik.com/free-photo/film-reel-with-film-strips_23-2148165780.jpg" },
        ];
        
        // This function will display the cards for a given category.
        function displayCards(category) {
            blogCards.innerHTML = ''; // Clear existing cards
            const filteredArticles = articles.filter(article => article.category === category);
            articlesData = filteredArticles; // Update global data
            
            if (filteredArticles.length === 0) {
                blogCards.innerHTML = `<p class="text-center text-gray-500 text-lg col-span-full">No articles found for this category.</p>`;
                return;
            }

            filteredArticles.forEach(article => {
                const card = document.createElement('div');
                card.className = "bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 cursor-pointer overflow-hidden";
                card.innerHTML = `
                    <img src="${article.image}" alt="${article.title}" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold text-gray-900 mb-2">${article.title}</h3>
                        <p class="text-gray-600 line-clamp-3">${article.content.replace(/(<([^>]+)>)/ig, "").substring(0, 150)}...</p>
                        <button class="mt-4 text-blue-600 font-bold hover:underline read-more-btn" data-id="${article.id}">Read More &rarr;</button>
                    </div>
                `;
                blogCards.appendChild(card);
            });

            // Add event listeners for the new cards
            document.querySelectorAll('.read-more-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const articleId = parseInt(event.target.dataset.id);
                    showArticle(articleId);
                });
            });
        }
        
        // This function shows the full article and hides the card grid.
        function showArticle(id) {
            const article = articles.find(a => a.id === id);
            if (article) {
                currentArticleIndex = articlesData.findIndex(a => a.id === id);
                blogCards.style.display = 'none';
                articleContainer.style.display = 'block';
                sectionTitle.style.display = 'none';
                articleTitle.textContent = article.title;
                articleImage.src = article.image;
                articleText.innerHTML = article.content;
                updateNavButtons();
            }
        }

        // Updates the visibility of the "Next" and "Back" buttons
        function updateNavButtons() {
            backBtn.style.display = (currentArticleIndex > 0) ? 'flex' : 'none';
            nextBtn.style.display = (currentArticleIndex < articlesData.length - 1) ? 'flex' : 'none';
        }

        // Hides the article view and shows the card grid again.
        function hideArticle() {
            articleContainer.style.display = 'none';
            blogCards.style.display = 'grid';
            sectionTitle.style.display = 'block';
        }

        // Function to handle SIP calculation
        function calculateSIP() {
            const amount = parseFloat(document.getElementById('sipAmount').value);
            const returnRate = parseFloat(document.getElementById('sipReturn').value) / 100;
            const years = parseFloat(document.getElementById('sipYears').value);

            if (isNaN(amount) || isNaN(returnRate) || isNaN(years) || amount <= 0 || years <= 0) {
                document.getElementById('sipResult').textContent = "Please enter valid numbers.";
                return;
            }

            const monthlyRate = returnRate / 12;
            const months = years * 12;

            const futureValue = amount * ((Math.pow(1 + monthlyRate, months) - 1) / monthlyRate) * (1 + monthlyRate);
            const totalInvestment = amount * months;
            const totalWealth = Math.round(futureValue);
            const gainedWealth = Math.round(totalWealth - totalInvestment);

            document.getElementById('sipResult').innerHTML = `
                <div class="mt-4">
                    <p class="font-bold text-gray-800">Total Wealth: ₹ ${totalWealth.toLocaleString('en-IN')}</p>
                    <p class="text-sm text-gray-600">Invested: ₹ ${totalInvestment.toLocaleString('en-IN')}</p>
                    <p class="text-sm text-gray-600">Gains: ₹ ${gainedWealth.toLocaleString('en-IN')}</p>
                </div>
            `;
        }

        // Function to handle Lumpsum calculation
        function calculateLumpsum() {
            const amount = parseFloat(document.getElementById('lumpsumAmount').value);
            const returnRate = parseFloat(document.getElementById('lumpsumReturn').value) / 100;
            const years = parseFloat(document.getElementById('lumpsumYears').value);

            if (isNaN(amount) || isNaN(returnRate) || isNaN(years) || amount <= 0 || years <= 0) {
                document.getElementById('lumpsumResult').textContent = "Please enter valid numbers.";
                return;
            }

            const futureValue = amount * Math.pow((1 + returnRate), years);
            const totalWealth = Math.round(futureValue);
            const gainedWealth = Math.round(totalWealth - amount);

            document.getElementById('lumpsumResult').innerHTML = `
                <div class="mt-4">
                    <p class="font-bold text-gray-800">Total Wealth: ₹ ${totalWealth.toLocaleString('en-IN')}</p>
                    <p class="text-sm text-gray-600">Invested: ₹ ${amount.toLocaleString('en-IN')}</p>
                    <p class="text-sm text-gray-600">Gains: ₹ ${gainedWealth.toLocaleString('en-IN')}</p>
                </div>
            `;
        }

        // Function to show the subscription toast
        function showSubscriptionToast() {
            subscriptionToast.classList.remove('scale-0', 'opacity-0');
            subscriptionToast.classList.add('scale-100', 'opacity-100');
            setTimeout(() => {
                subscriptionToast.classList.remove('scale-100', 'opacity-100');
                subscriptionToast.classList.add('scale-0', 'opacity-0');
            }, 3000);
        }

        // Function to show the notification modal
        function showNotificationModal(message, category) {
            notificationMessage.textContent = message;
            notificationModal.dataset.category = category;
            notificationModal.style.display = 'flex';
        }

        // Function to hide the notification modal
        function hideNotificationModal() {
            notificationModal.style.display = 'none';
        }

        // Auth state listener to set up Firestore listeners once authenticated
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                userIdDisplay.textContent = `User ID: ${userId}`;
                console.log("User signed in with ID:", userId);

                // Start Firestore listeners
                startFirestoreListeners(userId);

            } else {
                console.log("User signed out or not authenticated. Signing in anonymously.");
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }
            }
        });

        // Firestore listeners to handle real-time updates
        function startFirestoreListeners(uid) {
            // Path to the user's private profile document
            const userProfileRef = doc(db, `/artifacts/${appId}/users/${uid}/profile`, 'user_profile');

            // Listener for user's subscription status and last read time
            onSnapshot(userProfileRef, (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    userHasSubscribed = data.isSubscribed;
                    console.log("User subscription status:", userHasSubscribed);
                } else {
                    console.log("User profile not found. User is not subscribed.");
                    userHasSubscribed = false;
                }
                updateSubscriptionButton();
            }, (error) => {
                console.error("Error listening to user profile:", error);
            });

            // Path to the public notifications collection
            const publicNotificationsRef = collection(db, `/artifacts/${appId}/public/data/notifications`);
            
            // Listener for new notifications
            onSnapshot(publicNotificationsRef, async (querySnapshot) => {
                let latestNotification = null;
                querySnapshot.forEach(doc => {
                    const notification = doc.data();
                    if (!latestNotification || notification.timestamp > latestNotification.timestamp) {
                        latestNotification = notification;
                    }
                });
                
                // Get the user's last read timestamp
                const userDoc = await getDoc(userProfileRef);
                const lastRead = userDoc.exists() ? userDoc.data().lastReadTimestamp : null;

                if (userHasSubscribed && latestNotification && (!lastRead || latestNotification.timestamp > lastRead)) {
                    notificationBadge.classList.remove('hidden');
                    const category = latestNotification.category;
                    const message = latestNotification.message;
                    showNotificationModal(message, category);
                } else {
                    notificationBadge.classList.add('hidden');
                    hideNotificationModal();
                }
            }, (error) => {
                console.error("Error listening to public notifications:", error);
            });
        }

        // Function to update the subscription button text and state
        function updateSubscriptionButton() {
            if (userHasSubscribed) {
                subscribeBtn.textContent = 'Subscribed';
                subscribeBtn.disabled = true;
                subscribeBtn.classList.add('bg-gray-400', 'text-gray-700', 'cursor-not-allowed');
                subscribeBtn.classList.remove('bg-white', 'text-blue-600', 'hover:bg-gray-100');
            } else {
                subscribeBtn.textContent = 'Subscribe to Updates';
                subscribeBtn.disabled = false;
                subscribeBtn.classList.remove('bg-gray-400', 'text-gray-700', 'cursor-not-allowed');
                subscribeBtn.classList.add('bg-white', 'text-blue-600', 'hover:bg-gray-100');
            }
        }

        // Event listener for the subscribe button
        subscribeBtn.addEventListener('click', async () => {
            if (!userId) {
                console.error("User not authenticated.");
                return;
            }
            try {
                const userProfileRef = doc(db, `/artifacts/${appId}/users/${userId}/profile`, 'user_profile');
                await setDoc(userProfileRef, {
                    isSubscribed: true,
                    subscriptionDate: serverTimestamp(),
                }, { merge: true });
                showSubscriptionToast();
                console.log("User subscription status updated in Firestore.");
            } catch (e) {
                console.error("Error updating subscription:", e);
            }
        });

        // Event listener for the notification button
        document.getElementById('notificationBtn').addEventListener('click', async () => {
            if (!userId) {
                console.error("User not authenticated.");
                return;
            }
            // A simple way to get the latest notification to display in the modal
            const notifications = await getDocs(collection(db, `/artifacts/${appId}/public/data/notifications`));
            const latestNotification = notifications.docs.reduce((latest, current) => {
                const latestData = latest?.data() || { timestamp: 0 };
                const currentData = current.data();
                return currentData.timestamp > latestData.timestamp ? current : latest;
            }, null);

            if (latestNotification) {
                const data = latestNotification.data();
                showNotificationModal(data.message, data.category);

                // Update the user's last read timestamp
                const userProfileRef = doc(db, `/artifacts/${appId}/users/${userId}/profile`, 'user_profile');
                await setDoc(userProfileRef, {
                    lastReadTimestamp: data.timestamp
                }, { merge: true });
                notificationBadge.classList.add('hidden');
            } else {
                 console.log("No new notifications to display.");
            }
        });

        // Event listener for the close button inside the modal
        closeNotificationBtn.addEventListener('click', () => {
            hideNotificationModal();
        });

        // Event listener for the "Read Now" button in the modal
        readNowBtn.addEventListener('click', () => {
            const category = notificationModal.dataset.category;
            const article = articles.find(a => a.category === category);
            if (article) {
                hideNotificationModal();
                // Find and display the corresponding article (e.g., the first one in the category)
                currentCategory = category;
                const targetArticle = articlesData.find(a => a.category === category);
                if (targetArticle) {
                    showArticle(targetArticle.id);
                }
            } else {
                hideNotificationModal();
                console.log("No article found for this category.");
            }
        });

        // Initial display of cards
        window.onload = () => {
            displayCards(currentCategory);
            navLinks['nav-finance'].classList.add('text-blue-200'); // Set default active link
        };

        // Navigation links event listeners
        navLinks['nav-finance'].addEventListener('click', (event) => {
            event.preventDefault();
            displayCards('finance');
            sectionTitle.textContent = "Finance Articles";
            document.querySelector('.calculator-container').classList.remove('hidden');
            resetActiveNav();
            navLinks['nav-finance'].classList.add('text-blue-200');
            hideArticle();
        });

        navLinks['nav-technology'].addEventListener('click', (event) => {
            event.preventDefault();
            displayCards('technology');
            sectionTitle.textContent = "Technology Articles";
            document.querySelector('.calculator-container').classList.add('hidden');
            resetActiveNav();
            navLinks['nav-technology'].classList.add('text-blue-200');
            hideArticle();
        });

        navLinks['nav-entertainment'].addEventListener('click', (event) => {
            event.preventDefault();
            displayCards('entertainment');
            sectionTitle.textContent = "Entertainment Articles";
            document.querySelector('.calculator-container').classList.add('hidden');
            resetActiveNav();
            navLinks['nav-entertainment'].classList.add('text-blue-200');
            hideArticle();
        });

        // Reset active state for nav links
        function resetActiveNav() {
            Object.values(navLinks).forEach(link => {
                link.classList.remove('text-blue-200');
            });
        }
        
        // Navigation buttons for articles
        backBtn.addEventListener('click', () => {
            if (currentArticleIndex > 0) {
                currentArticleIndex--;
                showArticle(articlesData[currentArticleIndex].id);
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentArticleIndex < articlesData.length - 1) {
                currentArticleIndex++;
                showArticle(articlesData[currentArticleIndex].id);
            }
        });

    </script>
</body>
</html>
